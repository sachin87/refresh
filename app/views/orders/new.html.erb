<%= form_for(@order, html: { id: current_user.has_credit_card? ? 'order-form' : 'fill-credit-card-form' }) do |f| %>
  <%= f.hidden_field :delivery_time, value: @cart.delivery_time %>
  <br />
  <div class="col-sm-8 col-md-6 col-md-offset-1 col-lg-5 col-lg-offset-2">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h4>Checkout</h4>
      </div>
      <div class="panel-body">
        <!-- move to _form.html.erb -->
        <div class="row">
          <div class="col-lg-4">
            <h5>Delivery Address</h5>
            <br/>
          </div>
          <div class="col-lg-8">
            <div class="form-group">
              <%= f.select :delivery_address, current_user.addresses.map(&:full_address), required: true, selected: current_address.full_address, prompt: 'Select an address' %>
            </div>
          </div>
          <!-- div id="address-info" class="hidden">
            <div class="col-lg-12">
              <hr />
              <div class="col-xs-6">
                <div class="form-group">
                  <input type="first-name" class="form-control" placeholder="First Name">
                </div>
              </div>
              <div class="col-xs-6">
                <div class="form-group">
                  <input type="last-name" class="form-control" placeholder="Last Name">
                </div>
              </div>
              <div class="col-lg-9">
                <div class="form-group">
                  <input type="street-address" class="form-control" placeholder="Street Address">
                </div>
              </div>
              <div class="col-xs-4 col-lg-3">
                <div class="form-group">
                  <input type="apt" class="form-control" placeholder="Apt/Suite">
                </div>
              </div>
              <div class="col-xs-8 col-lg-6">
                <div class="form-group">
                  <input type="city" class="form-control" placeholder="City">
                </div>
              </div>
              <div class="col-xs-6 col-lg-3">
                <div class="form-group">
                  <input type="state" class="form-control" placeholder="State">
                </div>
              </div>
              <div class="col-xs-6 col-lg-3">
                <div class="form-group">
                  <input type="zip" class="form-control" placeholder="Zip">
                </div>
              </div>
              <div class="col-lg-12">
                <div class="form-group">
                  <input type="notes" class="form-control" id="card" placeholder="Notes (Gate Code / Instructions)">
                </div>
              </div>
              <div class="col-lg-12">
                <button type="submit" class="btn btn-default pull-right">Submit</button>
              </div>
            </div>
          </div -->
        </div>
        <hr />
        <a id="add-address" class="btn btn-default black">Add New Address</a>
        <hr />
        <div class="row">
          <div class="col-lg-4">
            <h5>Select Payment</h5>
            <br/>
          </div>
          <div class="col-lg-8">
            <!-- There's no multiple cards yet -->
            <!-- div class="form-group">
              <select class="form-control">
                <option disabled>Select payment method</option>
                <option value="" selected> Visa | 5809</option>
              </select>
            </div -->
          </div>

          <% unless current_user.has_credit_card? %>
            <div class="col-lg-12" id="payment-info">
              <hr />
              <div class="payment-errors"></div>
              <div class="col-lg-12">
                <div class="col-lg-12">
                  <div class="form-group">
                    <input type="text" class="form-control" placeholder="1234 5678 9012 3456" data-stripe="number">
                  </div>
                </div>
                <div class="col-xs-6 col-lg-3">
                  <div class="form-group">
                    <select class="form-control" data-stripe="exp-month">
                      <option value="" selected disabled>Month</option>
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                      <option value="6">6</option>
                      <option value="7">7</option>
                      <option value="8">8</option>
                      <option value="9">9</option>
                      <option value="10">10</option>
                      <option value="11">11</option>
                      <option value="12">12</option>
                    </select>
                  </div>
                </div>
                <div class="col-xs-6 col-lg-3">
                  <div class="form-group">
                    <select class="form-control" data-stripe="exp-year">
                      <option value="" selected disabled>Year</option>
                      <option value="2016">2016</option>
                      <option value="2017">2017</option>
                      <option value="2018">2018</option>
                      <option value="2019">2019</option>
                      <option value="2020">2020</option>
                      <option value="2021">2021</option>
                    </select>
                  </div>
                </div>
                <div class="col-xs-6 col-lg-3">
                  <div class="form-group">
                    <input type="text" class="form-control" placeholder="CCV" data-stripe="cvc">
                  </div>
                </div>
                <!-- Stripe doesn't require zip code -->
                <!-- div class="col-xs-6 col-lg-3">
                  <div class="form-group">
                    <input type="zip-code" class="form-control" id="card" placeholder="Zip Code">
                  </div>
                </div-->
                <!-- div class="col-lg-12">
                  <button type="submit" class="btn btn-default pull-right">Save</button>
                </div -->
              </div>
            </div>
          <% end %>
        </div>
        <hr />
        <a id="add-payment" class="btn btn-default black">Add New Card</a>
      </div>
    </div>
  </div>
  <div class="col-sm-4 col-md-4 col-lg-3">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h4>Order Summary</h4>
      </div>
      <div class="panel-body">
        <div class="row">
          <div class="col-xs-10">
            <h5>Subtotal</h5>
          </div>
          <div class="col-xs-2">
            <h5><%= humanized_money_with_symbol @cart.subtotal %></h5>
          </div>
          <div class="col-xs-10">
            <h5>Delivery</h5>
          </div>
          <div class="col-xs-2">
            <h5><%= humanized_money_with_symbol @cart.shipping_cost  %></h5>
          </div>
        </div>

        <hr />

        <div class="col-xs-10">
          <h4>Total</h4>
        </div>
        <div class="col-xs-2">
          <h4><%= humanized_money_with_symbol @cart.total %></h4>
        </div>
      </div>
      <div class="panel-footer">
        <button class="btn btn-default btn-block green">Checkout</button>
      </div>
    </div>
  </div>
<% end %>
